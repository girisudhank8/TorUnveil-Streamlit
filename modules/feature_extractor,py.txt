import numpy as np

def extract_features(flow):
    """
    Extract statistical features from a network flow.
    Expected input: dict or object with packet sizes & timings
    """

    packet_sizes = flow.get("packet_sizes", [])
    inter_arrival = flow.get("inter_arrival_times", [])

    features = {
        "pkt_count": len(packet_sizes),
        "total_bytes": sum(packet_sizes),
        "avg_pkt_size": np.mean(packet_sizes) if packet_sizes else 0,
        "std_pkt_size": np.std(packet_sizes) if packet_sizes else 0,
        "avg_iat": np.mean(inter_arrival) if inter_arrival else 0,
        "std_iat": np.std(inter_arrival) if inter_arrival else 0,
    }

    return features
